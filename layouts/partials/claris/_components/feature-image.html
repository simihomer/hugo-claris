{{- $page := .Page }}
{{- $meta := .Meta }}
{{- $title := .Title }}
{{- $debug := default false .Debug }}
{{/* {{- $debug = or $debug (not (not (findRE `about` $page.RelPermalink) ) ) }} */}}
{{- $template := "claris/_components/feature-image" }}

{{- $featureImage := false }}
{{- with .Meta.Single.Data.Images }}
  {{- with .feature.variant.default }}
    {{- $widest := 0 }}
    {{- range $versionName, $versionMeta := .version }}
      {{- if (gt .resource.Width $widest)  }}
        {{- $featureImage = . }}
        {{- $widest = .resource.Width }}
      {{- end }}
    {{- end }}
    {{ if $featureImage }}
      {{- $featureImageArgs := merge . (dict
        "resource" $featureImage.resource
        "FigureClass" "hero-image_above-main"
        "ImgClass" "hero-image_above-main_img"
        "Alt" .alt
        "Title" .title
        "LazyLoad" false) }}
      {{- if $debug }}
        {{- warnf "%s[%s]: Found feature image; now calling responsive-image with .resource=%v %v"
            $page $template $featureImageArgs.resource (jsonify (dict "indent" "  ") $featureImageArgs) -}}
      {{- end }}
      {{- partial "responsive-image" (merge $featureImageArgs (dict "Page" $page)) $featureImageArgs }}
    {{- end }}
  {{- end }}
{{- end }}
{{- if not $featureImage }}
  {{- if $debug }}
    {{- warnf "%s[%s]: No feature image found: %v" $page $template (jsonify (dict "indent" "  ") $featureImage) -}}
  {{- end }}
{{- end }}
